/* fromone 2015-02-06  by yansm*/
$.extend({getUrlVars:function(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b},getUrlVar:function(a){return $.getUrlVars()[a]},getRootPath:function(){var a=window.document.location.href,b=window.document.location.pathname,c=a.indexOf(b),d=a.substring(0,c),e=b.substring(0,b.substr(1).indexOf("/")+1);return d+e},setUrlWidthVars:function(a,b){var c=b+"/"+a.url+".html";return c},loadImg:function(b,c,d,e){function f(a,f){var i=new Image;i.onload=function(){g++,c&&c(g,b.length,a,f),d&&g==b.length&&d(h)},i.onerror=function(){g++,h++,e&&e(g,b.length,a,f)},i.src=a}var g=0,h=0,i="[object Object]"===Object.prototype.toString.call(b)?!0:!1,b=i?b.get():b;for(a in b){var j=i?$(b[a]).attr("data-src"):b[a];f(j,b[a])}}}),$(function(){var a=$("body"),b=$(".full-screen"),c=$(".loading-area"),d={level:1,type:"bottom",model:"index",url:"index"},e=["essay","css","index"],f=$.getRootPath(),g=[f+"/images/index-background.jpg",f+"/images/css-background.jpg"],h=function(c){a.removeClass(e.join(" ")).addClass(c),b.show(),setTimeout(function(){b.addClass("current")},100)},i=function(){b.removeClass("current"),setTimeout(function(){b.hide()},1370)};$(document).on("click",'[click-target="change-btn"]',function(){var a=$(this),b=a.data();j(b)});var j=function(a,b){a&&a.level&&a.type&&a.model||(a=d);var c=$.setUrlWidthVars(a,f);return b?void history.replaceState(a,"",c):(history.pushState(a,"",c),void l(a))};window.addEventListener("popstate",function(a){l(a.state)});var k=function(){},l=function(b){var c=a.data(),e=b;c&&c.level&&c.type&&c.model||(c=d),e&&e.level&&e.type&&e.model||(e=d);var f=c.level,g=e.level;if(f!=g||c.model!=e.model){var h=$.Event("hide."+c.type+"."+c.model+".level_"+f,{l_state:c,n_state:e});console.debug("hide."+c.type+"."+c.model+".level_"+f),a.trigger(h)}},m=function(b,c,d){var e=c.type,f=c.model,d=d+100;0==$("#"+e).length&&a.append("<div id="+e+"></div>"),$("#"+e).show().load(f+".html ."+f+"-area",function(b,g){if("error"==g)return void k();var h=$(this);"bottom"==e&&(d+=1400,i()),setTimeout(function(){h.find("."+f+"-area").addClass("current"),a.data(c)},d)})},n=function(c,d,e){var f=c.type,g=c.model,e=e;b.hasClass("current")||(h(d.model),e+=1400),a.find("."+g+"-area").removeClass("current"),setTimeout(function(){var b=$.Event("show."+d.type+"."+d.model+".level_"+d.level,{l_state:c,n_state:d});console.debug("show."+d.type+"."+d.model+".level_"+d.level),$("#"+f).hide(),a.trigger(b)},e)};a.on("show.bottom.index.level_1",function(a){var b=0;m(a.l_state,a.n_state,b)}).on("hide.bottom.index.level_1",function(a){var b=0;n(a.l_state,a.n_state,b)}).on("show.top.essay.level_1",function(a){var b=0;m(a.l_state,a.n_state,b)}).on("hide.top.essay.level_1",function(a){var b=500;n(a.l_state,a.n_state,b)}).on("show.bottom.css.level_1",function(a){var b=0;m(a.l_state,a.n_state,b)}).on("hide.bottom.css.level_1",function(a){var b=0;n(a.l_state,a.n_state,b)});var o=a.data();$("."+o.model+"-area").addClass("current"),"top"==o.type&&h(o.model),j(o,!0),$.loadImg(g,$.noop,function(){},$.noop),window.onload=function(){c.addClass("current"),setTimeout(function(){c.hide()},1e3)}});