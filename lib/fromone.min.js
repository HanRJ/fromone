/* fromone 2015-01-29  by yansm*/
$.extend({getUrlVars:function(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b},getUrlVar:function(a){return $.getUrlVars()[a]},setUrlWidthVars:function(a){var b=[];for(key in a)b.push(key+"="+a[key]+"&");return b=location.href.split("?")[0]+"?"+b.join(""),b=b.substring(0,b.length-1)}}),$(function(){var a=$("body"),b=$(".full-screen"),c={level:0,type:"normal",model:"index"},d=function(){b.show(),setTimeout(function(){b.addClass("current")},100)},e=function(){b.removeClass("current"),setTimeout(function(){b.hide()},1670)};$(document).on("click",'[click-target="change-btn"]',function(){var a=$(this),b=a.data();f(b)});var f=function(a){var b=$.setUrlWidthVars(a);history.pushState(a,"",b),h(a)};window.addEventListener("popstate",function(a){h(a.state)});var g=function(){},h=function(b){var d=a.data(),e=b;d&&d.level&&d.type&&d.model||(d=c),e&&e.level&&e.type&&e.model||(e=c);var f=d.level,g=e.level;if(g>f){var h=$.Event("show."+e.type+"."+e.model+".level_"+(f+1),{state:e});a.trigger(h)}else{if(f==g&&0==f)return;var h=$.Event("hide."+d.type+"."+d.model+".level_"+f,{state:e});a.trigger(h)}};a.on("show.top.essay.level_1",function(c){var e=$(this),f=0,h=c.state;return"essay"!=h.model&&2==h.level?void g():(a.stop(),e.removeClass().addClass("essay"),b.hasClass("current")||(d(),f=1670),void setTimeout(function(){$(".top-screen").show().load("essay.html",function(b,c){return"error"==c?void g():($(this).find(".essay-area").addClass("current"),void a.data(h))})},f))}).on("hide.top.essay.level_1",function(b){var c=($(this),b.state);0==c.level&&($(".top-screen .essay-area").removeClass("current"),setTimeout(function(){$(".top-screen").hide(),e(),a.data(c)},500))}),h($.getUrlVars())});